<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario de Instalación de Electromovilidad</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <img src="https://i.ibb.co/L5hYw4k/emechile.png" alt="Logo de EME Ingeniería Chile Limitada" class="logo">
        </div>

        <div class="title-section">
            <h1 class="main-title">Formulario de Instalación de Electromovilidad</h1>
            <button id="theme-toggle" class="theme-toggle">Modo Oscuro</button>
        </div>
        
        <div class="folio-section">
            <p><strong>Folio N°:</strong> <span id="folio-number"></span></p>
        </div>
        
        <div class="section borrador-loader">
            <h4>Cargar Borrador Existente</h4>
            <div class="form-group">
                <label for="folioToLoad">Ingresar Folio a Cargar:</label>
                <input type="text" id="folioToLoad" placeholder="Ej: 250">
                <button type="button" id="cargarBorradorBtn">Cargar Borrador</button>
            </div>
            <h4>Cargar Datos de Evaluación</h4>
            <div class="form-group">
                <label for="folioEvaluacionToLoad">Ingresar Folio de Evaluación:</label>
                <input type="text" id="folioEvaluacionToLoad" placeholder="Ej: 250">
                <button type="button" id="cargarEvaluacionBtn">Cargar Datos de Evaluación</button>
            </div>
        </div>

        <form id="instalacion-form">
            <div class="section">
                <h4>1. Datos del Cliente</h4>
                <div class="form-group">
                    <label for="nombre">Nombre:</label>
                    <input type="text" id="nombre" name="nombre" required>
                </div>
                <div class="form-group">
                    <label for="direccion">Dirección:</label>
                    <input type="text" id="direccion" name="direccion">
                </div>
            </div>

            <div class="section">
                <h4>2. Tipo de Propiedad</h4>
                <div class="form-group">
                    <label for="tipoPropiedad">Tipo de Propiedad:</label>
                    <select id="tipoPropiedad" name="tipoPropiedad">
                        <option value="">Seleccione...</option>
                        <option value="casa">Casa</option>
                        <option value="departamento">Departamento</option>
                    </select>
                </div>
            </div>

            <div class="section" id="detallesEvaluacionSection">
                <h4>3. Detalles de la Evaluación</h4>
                <div id="casa-fields" class="hidden">
                    <div class="form-group">
                        <label for="ubicacionCasa">Ubicación de la Instalación Propuesta:</label>
                        <input type="text" id="ubicacionCasa" name="ubicacionCasa">
                    </div>
                    <div class="form-group">
                        <label>Análisis de la Conexión Eléctrica:</label>
                        <label for="tipoConexionCasa">Tipo de Conexión:</label>
                        <select id="tipoConexionCasa" name="tipoConexionCasa"></select>
                    </div>
                    <div class="form-group">
                        <label for="amperajeCasa">Amperaje disponible:</label>
                        <select id="amperajeCasa" name="amperajeCasa"></select>
                    </div>
                </div>

                <div id="departamento-fields" class="hidden">
                    <div class="form-group">
                        <label for="numEstacionamientos">Número de Estacionamientos:</label>
                        <input type="number" id="numEstacionamientos" name="numEstacionamientos">
                    </div>
                    <div class="form-group">
                        <label for="ubicacionDepto">Ubicación de la Instalación Propuesta:</label>
                        <input type="text" id="ubicacionDepto" name="ubicacionDepto">
                    </div>
                    <div class="form-group">
                        <label for="permisoAdmin">Permiso de la Administración:</label>
                        <select id="permisoAdmin" name="permisoAdmin"></select>
                    </div>
                    <div class="form-group">
                        <label>Análisis de la Conexión Eléctrica:</label>
                        <label for="ubicacionConexionDepto">Ubicación de la conexión:</label>
                        <select id="ubicacionConexionDepto" name="ubicacionConexionDepto"></select>
                    </div>
                    <div class="form-group">
                        <label for="amperajeDepto">Amperaje disponible:</label>
                        <select id="amperajeDepto" name="amperajeDepto"></select>
                    </div>
                </div>
            </div>

            <div class="section" id="canalizacionSection">
                <h4>4. Análisis de la Canalización</h4>
                <div id="canalizacion-casa" class="hidden">
                    <label>Tipo de Ruta y Longitud:</label>
                    <div class="form-group">
                        <label for="metrosCag">Ducto C.A.G.:</label>
                        <input type="text" id="metrosCag" name="metrosCag" readonly> metros
                    </div>
                    <div class="form-group">
                        <label for="metrosEmtCasa">Ducto E.M.T.:</label>
                        <input type="text" id="metrosEmtCasa" name="metrosEmtCasa" readonly> metros
                    </div>
                    <div class="form-group">
                        <label for="metrosSoterrado">Soterrado:</label>
                        <input type="text" id="metrosSoterrado" name="metrosSoterrado" readonly> metros
                    </div>
                    <div class="form-group">
                        <label for="metrosPreembutidoCasa">Ducto Preembutido:</label>
                        <input type="text" id="metrosPreembutidoCasa" name="metrosPreembutidoCasa" readonly> metros
                    </div>
                    <p>Total de Metros: <span id="totalMetrosCasa">0</span></p>
                </div>
                <div id="canalizacion-depto" class="hidden">
                    <label>Tipo de Ruta y Longitud:</label>
                    <div class="form-group">
                        <label for="metrosEscalerilla">Escalerilla:</label>
                        <input type="text" id="metrosEscalerilla" name="metrosEscalerilla" readonly> metros
                    </div>
                    <div class="form-group">
                        <label for="metrosEmtDepto">Ducto E.M.T.:</label>
                        <input type="text" id="metrosEmtDepto" name="metrosEmtDepto" readonly> metros
                    </div>
                    <div class="form-group">
                        <label for="metrosPreembutidoDepto">Ducto Preembutido:</label>
                        <input type="text" id="metrosPreembutidoDepto" name="metrosPreembutidoDepto" readonly> metros
                    </div>
                    <p>Total de Metros: <span id="totalMetrosDepto">0</span></p>
                </div>
            </div>

            <div class="section">
                <h4>5. Instalación con Certificado S.E.C.</h4>
                <div class="form-group">
                    <label for="sec-cert-select">Instalación con Certificado S.E.C.:</label>
                    <select id="sec-cert-select" name="sec-cert-select">
                        <option value="">Seleccione...</option>
                        <option value="si">Sí</option>
                        <option value="no">No</option>
                    </select>
                </div>
            </div>

            <div class="section" id="registroFotografico">
                <h4>6. Registro Fotográfico</h4>
                <div id="sec-si-fotos" style="display: none;">
                    <div class="form-group">
                        <label for="fotoConexionUnion">Foto: Conexión punto de unión/empalme</label>
                        <input type="file" id="fotoConexionUnion" name="fotoConexionUnion" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label for="fotoTableroAbiertoSi">Foto: Tablero abierto</label>
                        <input type="file" id="fotoTableroAbiertoSi" name="fotoTableroAbiertoSi" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label for="fotoTableroCerradoSi">Foto: Tablero cerrado y etiquetado</label>
                        <input type="file" id="fotoTableroCerradoSi" name="fotoTableroCerradoSi" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label for="fotoMedicionTierra">Foto: Medición de tierra</label>
                        <input type="file" id="fotoMedicionTierra" name="fotoMedicionTierra" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label for="fotoCanalizacionSi">Foto: Imágenes trayecto canalización</label>
                        <input type="file" id="fotoCanalizacionSi" name="fotoCanalizacionSi" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label for="fotoEtiquetadoCable">Foto: Etiquetado de cable</label>
                        <input type="file" id="fotoEtiquetadoCable" name="fotoEtiquetadoCable" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label for="fotoEstacionamientoGeneral">Foto: Estacionamiento general</label>
                        <input type="file" id="fotoEstacionamientoGeneral" name="fotoEstacionamientoGeneral" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label for="fotoTableroEstacionamientoAbierto">Foto: Tablero estacionamiento abierto</label>
                        <input type="file" id="fotoTableroEstacionamientoAbierto" name="fotoTableroEstacionamientoAbierto" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label for="fotoTableroEstacionamientoCerrado">Foto: Tablero estacionamiento cerrado</label>
                        <input type="file" id="fotoTableroEstacionamientoCerrado" name="fotoTableroEstacionamientoCerrado" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label for="fotoFachada">Foto: Fachada</label>
                        <input type="file" id="fotoFachada" name="fotoFachada" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label for="fotoConfiguracionCargadorSi">Foto: Captura configuración cargador</label>
                        <input type="file" id="fotoConfiguracionCargadorSi" name="fotoConfiguracionCargadorSi" accept="image/*">
                    </div>
                </div>

                <div id="sec-no-fotos" style="display: none;">
                    <div class="form-group">
                        <label for="fotoTablero">Foto: Tablero</label>
                        <input type="file" id="fotoTablero" name="fotoTablero" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label for="fotoCanalizacion">Foto: Canalización</label>
                        <input type="file" id="fotoCanalizacion" name="fotoCanalizacion" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label for="fotoConfiguracionCargadorNo">Foto: Captura configuración cargador</label>
                        <input type="file" id="fotoConfiguracionCargadorNo" name="fotoConfiguracionCargadorNo" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label for="fotoCargador">Foto: Cargador</label>
                        <input type="file" id="fotoCargador" name="fotoCargador" accept="image/*">
                    </div>
                </div>
            </div>

            <div class="section">
                <h4>7. Checklist de Finalización</h4>
                <div class="form-group">
                    <input type="checkbox" id="checklist1" name="checklist1">
                    <label for="checklist1">Limpieza del lugar finalizada</label>
                </div>
                <div class="form-group">
                    <input type="checkbox" id="checklist2" name="checklist2">
                    <label for="checklist2">Pruebas de funcionamiento realizadas</label>
                </div>
                <div class="form-group">
                    <input type="checkbox" id="checklist3" name="checklist3">
                    <label for="checklist3">Instrucciones de uso entregadas al cliente</label>
                </div>
            </div>

            <div class="section">
                <h4>8. Notas</h4>
                <div class="form-group">
                    <textarea id="notas" name="notas" rows="6"></textarea>
                </div>
            </div>

            <div class="actions">
                <button type="button" id="guardarBtn">Guardar Borrador</button>
                <button type="submit" id="enviarBtn">Enviar Reporte</button>
                <a href="index.html" class="form-button">Volver a la página principal</a>
            </div>
        </form>
    </div>

    <script src="instalacion-electromovilidad.js"></script>
    
    <script>
        const themeToggleBtn = document.getElementById('theme-toggle');
        const body = document.body;

        const isDarkMode = localStorage.getItem('darkMode') === 'true';
        if (isDarkMode) {
            body.classList.add('dark-mode');
            themeToggleBtn.textContent = 'Modo Claro';
        }

        themeToggleBtn.addEventListener('click', () => {
            body.classList.toggle('dark-mode');
            const isCurrentlyDark = body.classList.contains('dark-mode');
            localStorage.setItem('darkMode', isCurrentlyDark);
            themeToggleBtn.textContent = isCurrentlyDark ? 'Modo Claro' : 'Modo Oscuro';
        });
    </script>
</body>
</html>